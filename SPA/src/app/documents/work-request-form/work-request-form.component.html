<h2 align="center">Work request</h2>

<div class="container">

    <div class="sidebar">

        <div class="navigation" align="center">
            <mat-card>
                <mat-card [ngClass]="{selected: currentlyShow=='basicInformation'}" class="mat-card-item" (click)="currentlyShow = 'basicInformation'">
                    Basic Information
                </mat-card>

                <mat-card [ngClass]="{selected: currentlyShow=='stateChanges'}" class="mat-card-item" routerLinkActive="list-item" (click)="currentlyShow = 'stateChanges'">
                    History of State Changes
                </mat-card>

                <mat-card [ngClass]="{selected: currentlyShow=='attach'}" class="mat-card-item" routerLinkActive="list-item" (click)="currentlyShow = 'attach'">
                    Multimedia Attchments
                </mat-card>

                <mat-card [ngClass]="{selected: currentlyShow=='equipment'}" class="mat-card-item" routerLinkActive="list-item" (click)="currentlyShow = 'equipment'">
                    Equipment
                </mat-card>
            </mat-card>
        </div>
    </div>


    <div class="components" align="center">
        
        <span *ngIf="currentlyShow == 'basicInformation'">
            <!-- form -->
            <mat-card class="">
                <form [formGroup]="workRequestForm" (ngSubmit)="submitWorkRequest()">
                    <div class="row">
                        <div class="form-row">

                        <mat-form-field class="example-full-width">
                            <mat-label>Type</mat-label>
                            <mat-select formControlName="workType">
                                <mat-option *ngFor="let type of types" [value]="type.value">
                                    {{type.viewValue}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>

                        <mat-form-field>
                            <mat-label>Incident (coming soon)</mat-label>
                            <input matInput formControlName="incident" placeholder="Import Incident" disabled>
                        </mat-form-field>

                    </div>

<!-- 
                        <mat-form-field class="example-full-width">
                            <mat-label>Equipment</mat-label>
                            <mat-select formControlName="equipment">
                                <mat-option *ngFor="let type of types" [value]="type.value">
                                    {{type.viewValue}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field> -->



                        <div class="form-row">

                            <mat-form-field class="example-full-width">
                                <mat-label>Start date/time</mat-label>
                                <input matInput [matDatepicker]="picker" placeholder="Start date/time"
                                    formControlName="startDate" required>
                                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                                <mat-datepicker #picker></mat-datepicker>
                            </mat-form-field>


                            <mat-form-field class="example-full-width">
                                <mat-label>End date/time</mat-label>
                                <input matInput [matDatepicker]="picker_" placeholder="End date/time"
                                    formControlName="endDate" required>
                                <mat-datepicker-toggle matSuffix [for]="picker_"></mat-datepicker-toggle>
                                <mat-datepicker #picker_></mat-datepicker>
                            </mat-form-field>
                        </div>

                        <div class="form-row">


                            <mat-form-field class="example-full-width">
                                <mat-label>Created By</mat-label>
                                <input matInput formControlName="userId">
                            </mat-form-field>

                            <mat-form-field class="example-full-width">
                                <mat-label>Document type</mat-label>
                                <input matInput formControlName="documentType">
                            </mat-form-field>


                        </div>


                        <mat-form-field class="example-full-width">
                            <mat-label>Purpose</mat-label>
                            <textarea matInput formControlName="purpose" required></textarea>
                        </mat-form-field>

                        <mat-form-field class="example-full-width">
                            <mat-label>Notes</mat-label>
                            <textarea matInput formControlName="additionalNotes" required></textarea>
                        </mat-form-field>


                        


                        <mat-form-field class="example-full-width">
                            <mat-label>Company</mat-label>
                            <input matInput formControlName="company" value="Company Name">
                        </mat-form-field>

                        <mat-form-field class="example-full-width">
                            <mat-label>Phone No</mat-label>
                            <input matInput formControlName="phoneNumber">
                        </mat-form-field>

                        <mat-form-field class="example-full-width">
                            <mat-label>Date/time Created</mat-label>
                            <input matInput [matDatepicker]="__picker" placeholder="Created"
                                formControlName="createdAt" required>
                            <mat-datepicker-toggle matSuffix [for]="__picker"></mat-datepicker-toggle>
                            <mat-datepicker #__picker></mat-datepicker>
                        </mat-form-field>

                        <br>
                        <mat-slide-toggle [checked]="emergencyWorkToggle"
                            (change)="emergencyWorkToggle = $event.source.checked">
                            Emergency Work
                        </mat-slide-toggle>
                        <br>


                        <button class="mt-3" mat-raised-button color="primary">Save</button>
                    </div>
                </form>
                <button *ngIf="workRequest" (click)="onDelete()" class="mt-3" mat-button color="secondary">Delete</button>
            </mat-card>
        </span>


        <span *ngIf="">
            <!-- calls -->
            <app-calls-table></app-calls-table>
        </span>

        <span *ngIf="">
            <!--  call form -->
            <app-call-report></app-call-report>
        </span>

        <span *ngIf="currentlyShow == 'equipment'">
            <mat-card>
                <p>equipment placeholder</p>
            </mat-card>
        </span>

        <span *ngIf="currentlyShow == 'stateChanges'">
            <mat-card *ngIf="workRequest.history.length == 0">
                <div>no changes have been made yet</div>
            </mat-card>

            <mat-card class="change" *ngFor="let change of workRequest.history">
                <div class="">{{change.changedAt  | date:'MM/dd/yyyy'}}</div>
                <div class="">{{change.content}} </div>
                <div class="">changed by: {{change.changedBy}}</div>
            </mat-card>
        </span>

        <span *ngIf="currentlyShow == 'attach'">
            <!-- multimedia attchments -->
            <mat-card class="attach" *ngFor="let attach of workRequest.attachments">
                <div class="">{{attach.fileName}}</div>
                <div class="">
                    <button mat-button color="primary" (click)="onDownload(attach.id)">download</button>
                    <button mat-button color="secondary" (click)="onDeleteAttach(attach.id)">delete</button>
                </div>
            </mat-card>
            <mat-card>
                <input hidden #fileInput type="file" id="file" (change)="onFileChanged($event)">
                <button mat-raised-button color="primary" (click)="fileInput.click()">Upload</button>
            </mat-card>

        </span>

    </div>

</div>
